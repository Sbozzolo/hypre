#!/bin/sh
# Copyright (c) 1998 Lawrence Livermore National Security, LLC and other
# HYPRE Project Developers. See the top-level COPYRIGHT file for details.
#
# SPDX-License-Identifier: (Apache-2.0 OR MIT)

# Create temporary file with list of MUP functions and methods
cat mup.functions mup.methods > mup.pre

############################################################################
# Generate code for multiprecision _pre functions
############################################################################

#========================================
# generate imples
#========================================

FOUT=mup_pre.c

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

#ifdef HYPRE_MIXED_PRECISION

#include "_hypre_krylov.h"
#include "lobpcg.h"

@

../config/write_header.sh >> $FOUT
../config/gen_pre_imples.sh mup.pre HYPRE_krylov.h _hypre_krylov.h HYPRE_lobpcg.h lobpcg.h >> $FOUT

cat >> $FOUT <<@

#endif

@

#========================================
# generate external protos
#========================================

FOUT=mup_pre_ext.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_pre_protos.sh mup.pre HYPRE_krylov.h >> $FOUT

#========================================
# generate external protos **FOR LOBPCG**
#========================================

FOUT=mup_pre_lobpcg_ext.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_pre_protos.sh mup.pre HYPRE_lobpcg.h >> $FOUT

#========================================
# generate internal protos
#========================================

FOUT=mup_pre_int.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_pre_protos.sh mup.pre _hypre_krylov.h >> $FOUT

#========================================
# generate internal protos **FOR LOBPCG**
#========================================

FOUT=mup_pre_lobpcg_int.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_pre_protos.sh mup.pre lobpcg.h >> $FOUT

############################################################################
# Generate code for multiprecision functions
############################################################################

#========================================
# generate imples
#========================================

FOUT=mup_functions.c

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

#ifdef HYPRE_MIXED_PRECISION

#include "_hypre_krylov.h"
#include "lobpcg.h"
#include "_hypre_krylov_mup_undef.h"
#include "mup_functions_ext.h"
#include "mup_functions_int.h"

@

../config/write_header.sh >> $FOUT
../config/gen_function_imples.sh mup.functions HYPRE_krylov.h _hypre_krylov.h HYPRE_lobpcg.h lobpcg.h >> $FOUT

cat >> $FOUT <<@

#endif

@

#========================================
# generate external protos
#========================================

FOUT=mup_functions_ext.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_function_protos.sh mup.functions HYPRE_krylov.h HYPRE_lobpcg.h >> $FOUT

#========================================
# generate internal protos
#========================================

FOUT=mup_functions_int.h

cat > $FOUT <<@

/*** DO NOT EDIT THIS FILE DIRECTLY (use $0 to generate) ***/

@

../config/write_header.sh >> $FOUT
../config/gen_function_protos.sh mup.functions _hypre_krylov.h lobpcg.h >> $FOUT

